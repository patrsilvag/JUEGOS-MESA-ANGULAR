<section class="form-container">

  <h2 class="form-title">Mi Perfil</h2>

  <!-- ==========================
       FORMULARIO DATOS PERSONALES
  =========================== -->
  <form [formGroup]="formDatos" (ngSubmit)="guardarDatos()" novalidate>

    <!-- NOMBRE -->
    <div class="form-group">
      <label>Nombre completo:</label>
      <input
        type="text"
        class="form-control"
        formControlName="nombre"
        placeholder="Ej: Juan PÃ©rez"
      />
      <small *ngIf="fcDatos('nombre').touched && fcDatos('nombre').invalid" class="error">
        Este campo es obligatorio.
      </small>
    </div>

    <!-- USUARIO -->
    <div class="form-group">
      <label>Nombre de usuario:</label>
      <input
        type="text"
        class="form-control"
        formControlName="usuario"
      />
      <small *ngIf="fcDatos('usuario').touched && fcDatos('usuario').invalid" class="error">
        Este campo es obligatorio.
      </small>
    </div>

    <!-- CORREO (DESHABILITADO / NO EDITABLE) -->
    <div class="form-group">
      <label>Correo electrÃ³nico:</label>
      <input
        type="email"
        class="form-control"
        formControlName="correo"
        [disabled]="true"
      />
    </div>

    <!-- FECHA NACIMIENTO -->
    <div class="form-group">
      <label>Fecha de nacimiento:</label>
      <input
        type="date"
        class="form-control"
        formControlName="fechaNacimiento"
      />
      <small *ngIf="fcDatos('fechaNacimiento').touched && fcDatos('fechaNacimiento').invalid"
             class="error">
        Este campo es obligatorio.
      </small>
    </div>

    <!-- DIRECCIÃ“N -->
    <div class="form-group">
      <label>DirecciÃ³n:</label>
      <input
        type="text"
        class="form-control"
        formControlName="direccion"
        placeholder="Ej: Av. Siempre Viva 123"
      />
    </div>

    <!-- BOTÃ“N GUARDAR -->
    <button type="submit" class="btn-primary mt-3">Guardar cambios</button>

  </form>

  <!-- MENSAJE DE Ã‰XITO -->
  <div *ngIf="mensajeExito" class="alert alert-success text-center mt-3">
    âœ” Datos actualizados correctamente.
  </div>

  <hr class="my-4" />

  <!-- ==========================
       CAMBIAR CONTRASEÃ‘A
  =========================== -->
  <h3 class="form-title" style="font-size: 1.3rem;">Cambiar contraseÃ±a</h3>

  <form [formGroup]="formClave" (ngSubmit)="actualizarClave()" novalidate>

    <!-- CLAVE ACTUAL -->
    <div class="form-group">
      <label>ContraseÃ±a actual:</label>
      <div class="password-group">
        <input
          [type]="verActual ? 'text' : 'password'"
          class="form-control"
          formControlName="claveActual"
        />
        <button type="button" class="btn-ojo" (click)="verActual = !verActual">ğŸ‘ï¸</button>
      </div>
      <small *ngIf="fcClave('claveActual').touched && fcClave('claveActual').invalid" class="error">
        Debes ingresar tu contraseÃ±a actual.
      </small>
    </div>

    <!-- NUEVA CLAVE -->
    <div class="form-group">
      <label>Nueva contraseÃ±a:</label>
      <div class="password-group">
        <input
          [type]="verNueva ? 'text' : 'password'"
          class="form-control"
          formControlName="nuevaClave"
        />
        <button type="button" class="btn-ojo" (click)="verNueva = !verNueva">ğŸ‘ï¸</button>
      </div>

      <!-- REGLAS -->
      <div class="reglas" *ngIf="fcClave('nuevaClave').touched">
        <span [class.ok]="!fcClave('nuevaClave').errors?.['minlength']">MÃ­n. 6</span>
        <span [class.ok]="!fcClave('nuevaClave').errors?.['uppercase']">MayÃºscula</span>
        <span [class.ok]="!fcClave('nuevaClave').errors?.['number']">NÃºmero</span>
        <span [class.ok]="!fcClave('nuevaClave').errors?.['special']">Especial</span>
      </div>
    </div>

    <!-- REPETIR CLAVE -->
    <div class="form-group">
      <label>Repetir nueva contraseÃ±a:</label>
      <div class="password-group">
        <input
          [type]="verRepetir ? 'text' : 'password'"
          class="form-control"
          formControlName="repetirClave"
        />
        <button type="button" class="btn-ojo" (click)="verRepetir = !verRepetir">ğŸ‘ï¸</button>
      </div>

      <small
        *ngIf="formClave.errors?.['noCoinciden'] && fcClave('repetirClave').touched"
        class="error"
      >
        Las contraseÃ±as no coinciden.
      </small>
    </div>

    <!-- ERROR CONTRASEÃ‘A INCORRECTA -->
    <small *ngIf="formClave.errors?.['incorrecta']" class="error">
      La contraseÃ±a actual no es correcta.
    </small>

    <!-- BOTÃ“N ACTUALIZAR -->
    <button type="submit" class="btn-primary mt-3">Actualizar contraseÃ±a</button>

  </form>

</section>
